<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.jian.project1.board.BoardMapper">
	
	<insert id="insBoard" useGeneratedKeys="true" keyProperty="boardPk">
		INSERT INTO project1_board
		(category, seq, title, ctnt, userPk)
		SELECT #{category}, IFNULL(MAX(seq), 0) +1, #{title}, #{ctnt}, #{userPk}
		FROM project1_board
		WHERE category = #{category}
	</insert>

	<select id="selBoardList" resultType="BoardDomain">
		SELECT A.boardPk, A.seq, A.title, A.hits, A.regDt
		, A.userPk, B.userNm AS writerNm, B.profileImg, A.ctnt
		FROM project1_board A
		INNER JOIN project1_user B
		ON A.userPk = B.userPk
		WHERE A.category = #{category}
		AND A.isDel = 0
		ORDER BY boardPk DESC;
	</select>
</mapper>